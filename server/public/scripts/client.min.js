var myApp=angular.module("myApp",["ngRoute"]);myApp.config(["$routeProvider","$locationProvider",function(a,b){b.hashPrefix(""),a.when("/login",{templateUrl:"/views/templates/login.html",controller:"LoginController"}).when("/register",{templateUrl:"/views/templates/register.html",controller:"LoginController"}).when("/user",{templateUrl:"/views/templates/user.html",controller:"UserController",resolve:{getuser:["UserService",function(a){return a.getuser()}]}}).when("/newstudent",{templateUrl:"/views/templates/newstudent.html",controller:"StudentController",resolve:{getuser:["UserService",function(a){return a.getuser()}]}}).when("/addlesson",{templateUrl:"/views/templates/addlesson.html",controller:"LessonController",resolve:{getuser:["UserService",function(a){return a.getuser()}]}}).when("/mystudent",{templateUrl:"/views/templates/mystudent.html",controller:"UserController",resolve:{getuser:["UserService",function(a){return a.getuser()}]}}).otherwise({redirectTo:"login"})}]),myApp.controller("LessonController",["$scope","$http","$location","UserService","StudentService",function(a,b,c,d,e){a.getStudents=e.getStudents,a.getStudents(),a.userObject=d.userObject,a.logout=d.logout,a.studentObject=e.studentObject,a.studentList=e.studentList,a.lesson={},a.addLesson=function(b){a.lesson=b,console.log("logging lesson: ",b),console.log("logging scope.lesson: ",a.lesson)},sweetAlert=function(){swal({title:"Success!",text:"Sweet, your lesson has been added!",type:"success"}),c.path("/user")}}]),myApp.controller("LoginController",["$scope","$http","$location","UserService",function(a,b,c,d){a.user={username:"",password:""},a.message="",a.login=function(){""===a.user.username||""===a.user.password?a.message="Enter your username and password!":(console.log("sending to server...",a.user),b.post("/",a.user).then(function(b){b.data.username?(console.log("success: ",b.data),c.path("/user")):(console.log("failure: ",b),a.message="Wrong!!")}))},a.registerUser=function(){""===a.user.username||""===a.user.password?a.message="Choose a username and password!":(console.log("sending to server...",a.user),b.post("/register",a.user).then(function(a){console.log("success"),c.path("/home")},function(b){console.log("error"),a.message="Please try again."}))}}]),myApp.controller("StudentController",["$scope","$http","$location","UserService",function(a,b,c,d){console.log("in StudentController"),a.userObject=d.userObject,console.log("logging userObject",a.userObject),a.logout=d.logout,a.student={name:"",email:"",instrument:"",day:""},sweetAlert=function(){swal({title:"Success!",text:"Sweet, your student has been added!",type:"success"})},a.addStudent=function(d){console.log("add student function running"),d.teacher=a.userObject.id,b.post("/student",d).then(function(a){console.log("back from the server with success!",a),c.path("/user"),sweetAlert()})}}]),myApp.controller("UserController",["$scope","$http","$location","UserService","StudentService",function(a,b,c,d,e){a.userObject=d.userObject,a.logout=d.logout,a.getStudents=e.getStudents,a.studentList=e.studentList,a.studentObject=e.studentObject,a.studentView=e.studentView,a.newStudent=function(){c.path("/newstudent")},a.addLesson=function(){c.path("/addlesson")},a.getStudents(),console.log("logging scope.studentList",a.studentList)}]),myApp.factory("AlertService",["$http","$location",function(a,b){return{}}]),myApp.factory("StudentService",["$http","$location",function(a,b){function c(){a.get("/student").then(function(a){e.students=a.data,console.log("response.data in getStudents: ",a.data),console.log("studentList in getStudents: ",e)})}function d(a){console.log("logging what is passed into studentView: ",a),f.data=a,console.log("logging studentObject",f),b.path("/mystudent")}var e={students:[]},f={data:""};return{studentList:e,getStudents:c,studentObject:f,studentView:d}}]),myApp.factory("UserService",["$http","$location",function(a,b){console.log("User Service Loaded");var c={};return{userObject:c,getuser:function(){a.get("/user").then(function(a){a.data.username?(c.id=a.data.id,c.userName=a.data.username,console.log("User Data: ",c.userName,c.id)):b.path("/login")})},logout:function(){a.get("/user/logout").then(function(a){console.log("logged out"),b.path("/login")})}}}]);